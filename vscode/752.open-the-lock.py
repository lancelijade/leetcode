#
# @lc app=leetcode id=752 lang=python3
#
# [752] Open the Lock
#

from collections import defaultdict, deque
from var_dump import var_dump
import pprint
pp = pprint.PrettyPrinter()
from datetime import datetime 
time_start = datetime.now()


# @lc code=start
class Solution:
    def openLock(self, deadends: list[str], target: str) -> int:

        if "0000" in deadends: return -1

        q = deque()
        q.append('0000')

        visited = set()

        steps = {}
        steps['0000'] = 0
        for t in deadends:
            steps[t] = -1

        if target in steps: return steps[target]

        while q:
            s = q.popleft()
            #print("s=", s)
            if s in visited: continue
            visited.add(s)
            step = steps[s]
            n = list(s)

            for i in range(4):

                t = n[i]

                n[i] = int(n[i]) + 1
                if n[i] == 10: n[i] = 0
                n[i] = str(n[i])
                nn1 = ''.join(n)
                n[i] = t

                n[i] = int(n[i]) - 1
                if n[i]<0: n[i] += 10
                n[i] = str(n[i])
                nn2 = ''.join(n)
                n[i] = t

                #print(s, nn1, nn2, step)

                if nn1 == target or nn2 == target: 
                    return step+1
                
                if nn1 not in visited and nn1 not in steps:
                    q.append(nn1)
                    steps[nn1] = step+1
                    #print("step", nn1, step+1)
                
                if nn2 not in visited and nn2 not in steps:
                    q.append(nn2)
                    steps[nn2] = step+1
                    #print("step", nn2, step+1)

                #print(q)

        return -1
        
# @lc code=end


deadends = ["0201","0101","0102","1212","2002"]
target = "0202"

#deadends = ["8888"]
#target = "0009"

#deadends = ["8887","8889","8878","8898","8788","8988","7888","9888"]
#target = "8888"

deadends = ["0201","0101","0102","1212","2002"]
target = "0000"

"""
deadends = ["6753","6001","3156","3464","3946","0958","0179","8178","2155","6694","5440","6507","0593","0762","9024","4451","3505","0210","5738","5921","7866","8392","7115","4735","9284","8189","7549","9801","9127","0308","4071","1243","4236","7034","6449","8451","2902","2924","8062","7080","3741","7580","2255","2834","4674","4584","2580","4108","9584","7248","2791","8380","0072","2800","4470","5691","2377","1067","8447","9468","3411","1324","9894","8662","3099","2393","8137","9405","6881","3156","0816","8833","4716","2512","8806","6414","6454","3736","1856","2659","9587","7680","3713","0991","5778","5270","8033","5982","5423","3063","6093","7615","8898","1527","6894","9938","9362","3649","0517","3855","1399","1060","9994","0945","6907","4122","2404","6031","4558","9062","3092","7005","3175","4072","2913","3181","2103","8350","4812","0990","2751","6393","0536","9516","9620","7609","2415","2285","7138","8651","0157","2192","5336","1853","4651","6734","4753","6114","4499","5821","9838","3470","5912","2153","2770","4349","3801","9828","9293","2459","1318","9331","7521","8579","7228","9683","4349","8665","1059","3747","5775","8819","2064","9452","5148","8124","5344","3718","3351","2214","6458","5797","1780","4428","8249","0724","4819","3371","1064","2249","3271","7644","6889","8525","8648","9501","5405","6152","8969","1541","7651","2382","4194","3677","0498","6445","7017","8921","5774","2555","1749","7457","6700","3442","7963","0200","0011","5913","6894","6306","7120","7891","5519","1188","9710","0653","5592","9695","9496","5972","8488","3794","6491","0506","5803","8312","5829","3176","2543","0221","5743","2413","7429","7350","5094","2009","2556","2809","9255","8946","1926","6407","8791","6004","4348","2689","0749","6779","0191","4430","5679","4641","5444","5224","2622","7594","2579","9909","7112","5912","2369","0381","6931","2681","8302","3528","5985","5045","7718","0348","3408","4708","2830","8801","2225","9443","9957","3973","0258","5579","5631","6531","2576","8798","1331","4866","2088","7615","9971","9611","9981","5259","8592","9379","3639","1063","4899","4930","2388","2078","1452","1121","7216","6968","8037","1927","3681","2710","6793","5634","6511","4646","3487","5608","1312","3791","8312","7384","9905","7556","3454","3192","1611","5544","3189","6936","2541","0447","2839","3409","4519","4527","3584","3210","7688","8799","1815","2078","9518","4743","8960","6088","1679","5313","8199","4339","6812","0790","7127","2104","4441","8265","9273","6305","4958","9853","0492","1319","8882","3449","6095","6996","1667","4136","3968","0411","2766","4305","2857","2240","2460","4230","6711","0689","4520","0154","2444","9346","1616","3701","8071","4876","2827","3944","4563","8903","5540","7223","0588","7365","8994","9226","0770","4199","3525","4187","2145","2117","9147","1797","5196","8206","3094","5877","2088","2903","8448","9155","7809","2571","7698","0623","3425","7635","0261","4903","6257","9154","3921","5525","6187","8374","6586","1337","1205","0375","1902","3048","1091","2085","5699","2241","5548","9599","6466","8341","7110","2023","3756","5629","4179","1870","0167","5327","3351","0966","6304","5993","9163","4644","7279","2211","4455","6925","5946","0317","3327","5370","5940","8617","2879","0236","7689","7861","1300","6415","7906","7197","5492","8980","1754","4571","7189","0142","5821","2564","5747","5422","1101","3942","3961","4277","6276","3174","3055","7644","6621","8553","6920","2118","7503","0325","6672","4382","1793","3550","1179","3357","2927","8101"]
target = "6120"

deadends = ["7294","9558","2053","4148","9984","6265","0107","3314","2456","1731","2521","8421","4206","9111","1917","6515","5256","8916","5743","1698","1337","5127","9389","3882","6278","3578","9971","0705","1663","4122","5904","4323","9622","2906","7670","4812","0148","7491","8896","9219","5695","8985","5567","9344","8447","8546","4988","3322","0192","7896","2559","1750","1624","2535","1052","8728","1639","1800","1654","4528","5475","6208","1954","6305","4044","7440","2383","7328","8876","1183","9140","1266","6974","3081","9633","9384","5051","8626","8530","4091","8387","1630","2096","9801","9632","0059","8599","0048","0008","4879","8339","0848","6542","4318","9342","9904","5468","0638","0545","6801","4056","0504","5928","7165","1171","3755","1782","4917","1755","1828","2747","4886","5169","6584","2238","9395","4690","9058","5739","6084","9888","4688","7224","1186","5850","9865","1001","2593","1108","2354","7602","1721","1147","9273","0146","1292","7385","1710","8161","4189","8154","9256","0255","0152","8400","7683","1730","6465","3432","4031","1268","9030","1838","8517","7206","8293","0618","6125","9195","0366","5391","6712","1748","6764","6379","9489","1050","1469","8390","9615","4510","0999","7859","9012","4003","7828","0963","7755","3737","4548","8284","8041","0462","4022","9684","0039","1717","7249","6005","7711","0301","4073","4468","8811","7076","5909","8616","6223","0318","6709","2722","2636","9288","7322","8947","3195","2594","2268","8830","5035","9847","0764","0797","8539","7169","6723","8989","3554","1559","9940","7337","5833","9107","6045","4280","8260","2783","4757","5882","7728","0820","6737","9797","4151","2220","7343","2640","4830","0772","5016","6368","5303","3830","8807","7203","7852","1363","0491","9533","6863","1297","8243","1293","7791","4120","3014","3343","8065","6886","0598","4524","4353","1465","5504","4147","6537","1034","3655","4572","5935","1050","6770","4763","0337","9409","7739","6728","8286","3178","7062","7509","2534","3711","5715","9844","4240","8299","1617","4626","9681","1486","8346","5466","0820","2887","5680","0571","3451","3238","0804","6634","1909","8368","4224","0221","7466","9116","8067","1952","7760","7387","3389","6781","7658","7310","6655","2978","3220","2396","5444","8469","9639","2984","5995","8963","3752","7030","5017","4805","4804","1747","4551","3512","2774","3315","9987","3592","0382","5033","4716","9050","1966","9397","0880","6403","5562","3117","5860","4091","2598","3635","0909","9756","7367","2858","3960","0409","7880","3002","5250","6486","3902","3392","5521","3053","0799","2875","7146","0783","4916","6437","5769","7174","2259","0690","6488","2491","6030","4812","7159","1269","9199","0110","4186","3167","6046","9214","4751","4106","2047","4204","4000","0731","4044","9964","7390","5106","1159","7825","0422","9194","3566","7920","1675","2109","1435","3340","6202","9498","9726","8776","2670","4638","4684","6766","9117","7139","8954","4179","9321","0645","2834","5078","4208","0094","0218","5445","7495","0184","5783","2052","4483","8783","3124","2823","6856","7500","7582","9828","9537","2865","5643","7343","5126","0667","8492","1863","6886","3026","1306","5945","5133","5632","4255","4813","1362","1058","1848","3259","9933","7960","2613","9662","9932","5843","0044","4444","2648","8433","9424","0683","8107","8030","6900","4791","4273","7336","1748","1054","4555","4897","6156","2527","5135","6485","3616","2783","9091","5476","3643","1789","5704","8333","2745","7280","9618","6409","9416","1102","2878"]
target = "0276"

deadends = ["0000"]
target = "8888"
"""

deadends = ["7887","7876","8677","7667","8686","6688","6777","8687","8877","8668","6676","7778","7788","6766","7687","6688","6867","8866","7878","6776","6888","7888","6767","8787","6876","8788","6767","7667","8768","8877","6786","7878","6888","8786","7866","8887","8866","8788","6787","7676","7766","7867","7687","6676","6776","6878","7876","7888","8877","7788","7876","8687","8866","8776","7666","7887","7787","6768","7876","8776","6877","8666","8868","8876","8868","6778","7887","6787","7878","7766","6887","7776","7867","6677","8788","7778","7878","8786","6667","7776","7687","6888","7776","6887","6788","7768","6767","7886","6787","7876","8678","7677","8776","7866","6777","6778","8788","8766","8768","8867","6876","7876","6766","6786","7786","7888","8868","8688","8788","6666","6788","6688","8887","7866","7878","6777","6786","7688","7677","7777","6767","6877","7677","6888","7668","8677","7668","8788","7666","7688","7688","7887","8877","7687","6868","6687","6668","6667","6886","6888","7676","7867","8786","7686","8666","7668","6766","7877","6667","7886","8786","6866","7788","6877","8878","7767","7766","7786","8788","7888","7778","8876","8778","6786","8786","8777","6667","8687","6776","8788","6878","8678","6887","8788","7676","8888","6788","7878","7878","8867","6767","8688","7888","6877","7866","7678","8878","8786","7887","6866","8668","7868","6887","6688","7686","6876","7677","7868","6876","6877","7678","7766","8787","6676","8776","6767","8877","6868","8786","8887","8776","7867","7678","8868","8887","6767","8778","7768","7666","7876","8686","7868","6777","8877","8888","6686","8768","6768","6768","8686","7776","7877","8887","6677","8878","8678","6677","7678","7768","6868","7867","7888","6788","6886","8677","8667","8788","7677","8678","8766","7686","8888","7666","7678","6676","8776","6668","8867","8668","8776","8687","8888","7778","6878","7678","6686","8667","8786","8877","7768","7666","8777","7878","8888","7787","7666","8676","6666","8778","6767","8886","7877","8787","7666","8868","7868","8887","8667","6787","7776","7778","6677","6877","6668","6767","8788","8866","8787","8676","6878","8787","6668","8776","8877","8778","8887","8887","7688","7886","7766","7887","7888","8866","6876","6868","6786","6788","8777","7668","6686","6867","7777","8678","6688","6878","8778","8877","6776","8776","7768","6678","8866","8677","8667","6667","6786","8867","6776","6787","7787","7777","6668","6777","6777","8778","6866","7786","7777","6866","8776","7666","8777","8876","7667","8678","8778","7776","6877","6787","7767","7777","6787","6678","6868","7886","6688","6888","6877","8887","6786","6876","7688","7686","8677","7766","7667","7676","6867","7666","8778","6786","7676","8777","8786","6687","7867","6788","6868","6868","7887","8778","7778","6777","8678","7876","8888","8687","6686","7887","8677","6688","7788","7776","7766","7768","6866","7666","7778","6676","6677","8776","8676","6866","8666","7787","7687","8676","7766","7777","8686","7888","7676","6666","7667","6886","6678","6888","8788","7867","8776","7768","7767","8778","7666","8667","7876","8868","6678","6766","6888","7678","6678","8878","7678","7876","7768","8678","6866","6787","6868","8778","8688","8688","8666","7776","7686","8876","6786","7878","8777","6766","7676","7686","8677","6768","8886","6766","8678","7878","8788","7688","7766","7677","7668","7678","8686","6888","8868","7887","8766","8678","6767","7877","6888","7666","8787","7767","6766","8677","7868","6778","7687","7766","6768","6786","8886","6688","8678","7778","6777"]
target = "8767"

so = Solution()
r = so.openLock(deadends, target)
print(r)


time_end = datetime.now()
print("---\ntime cost:",time_end-time_start)